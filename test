---
- name: Create user and set up home directory with permissions
  hosts: all
  become: yes

  tasks:
    - name: Ensure the user 'mgmtbld' is present with UID 777
      user:
        name: mgmtbld
        uid: 777
        home: /home/mgmtbld
        create_home: yes
        shell: /bin/bash

    - name: Ensure the home directory exists
      file:
        path: /home/mgmtbld
        state: directory
        owner: mgmtbld
        group: mgmtbld
        mode: '0777'

    - name: Set permissions to allow everyone to upload and change files
      acl:
        path: /home/mgmtbld
        recurse: yes
        entry: 'u::rwx,g::rwx,o::rwx'
        state: present

    - name: Set default ACL for new files and directories
      acl:
        path: /home/mgmtbld
        recurse: yes
        entry: 'd:u::rwx,d:g::rwx,d:o::rwx'
        state: present


You can inform the team with a message like this:

---

Dear Team,

I am updating the cleanup policy in Google Cloud Artifact Registry across all repositories. The policy will delete artifacts every 90 days automatically. 

I kindly request everyone to ensure that important images are kept in the Artifact Registry or consider adding automation to update images at least every 85 days. This way, they will be excluded from deletion.

Please feel free to raise any concerns or questions regarding this update.

Best regards,
[Your Name]

---
